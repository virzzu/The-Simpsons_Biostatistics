```{r obesidad}
df_simpsons <- data %>%
mutate(
# 1. Crear la categoría de 3 niveles para el gráfico del Paso 4
cat_imc = case_when(
imc_kg_m2 < 25 ~ "Normal",
imc_kg_m2 >= 25 & imc_kg_m2 < 30 ~ "Sobrepeso",
imc_kg_m2 >= 30 ~ "Obesidad"
),
# 2. Crear la variable BINARIA para la Regresión Logística del Paso 7
# Esta es la que sustituye a "Metástasis"
target_obesidad = ifelse(imc_kg_m2 >= 30, 1, 0),
# Convertirla a factor para que la regresión funcione bien
target_obesidad = factor(target_obesidad, labels = c("No Obeso", "Obeso"))
)
# Comprobación rápida: ¿Cuántos obesos hay?
table(df_simpsons$target_obesidad)
library(nortest) #para el test de kolmogorov
library(patchwork)
library(purrr)
library(ggplot2)
nombres_genes <- names(df_genes)
norm_genes <- lapply(df_genes, lillie.test) # aplicar test norm a los genes
p_values <- sapply(norm_genes, function(x) x$p.value) # sacar los p values
p_values_sci <- ifelse(p_values < 0.001, "<0.001", round(p_values, 3))
tabla_norm <- data.frame(
Test_utilizado = sapply(norm_genes, function(x) x$method),
Valor_p = p_values_sci,
Normalidad = ifelse(p_values > 0.05, "Sí (Media/SD)", "No (Mediana/IQR)")
) #generar un dataframe para poder imprimir la tabla
knitr::kable(tabla_norm,
caption = "Tabla 1. Resultados de evaluación de Normalidad en los\
datos de los genes mediante Kolmogorov-Smirnov.",
digits = 3)  #genero la tabla para que se muestre
# Unir todos los graficos en uno con patchwork
reduce(list_norm, `+`) + plot_layout(ncol = 4) + plot_annotation(
title = "Expresión génica",
theme = theme(plot.title = element_text(hjust = 0.5, size = 20, face = "bold")))
library(stats)
pca.results <- prcomp(df_genes, center=TRUE, scale.=TRUE)
# Resultado de las componentes principales, x es el elemento de las puntuaciones del
# PCA que devuelve prcomp(). Es lo que estamos buscando.
pca.df <- data.frame(pca.results$x)
# Varianza (cuadrado de la desviacion tipica)
varianzas <- pca.results$sdev^2
# Total de la varianza de los datos
total.varianza <- sum(varianzas)
# Varianza explicada por cada componente principal
varianza.explicada <- varianzas/total.varianza
# Calculamos la varianza acumulada
varianza.acumulada <- cumsum(varianza.explicada)
# Tomamos el numero de componentes principales que explican el 90% de la varianza
n.pc <- min(which(varianza.acumulada > 0.90))
# Etiquetas de los ejes del gráfico
x_label <- paste0(paste('PC1', round(varianza.explicada[1] * 100, 2)), '%')
y_label <- paste0(paste('PC2', round(varianza.explicada[2] * 100, 2)), '%')
# Representación gráfica de las primeras dos componentes principales respecto a los datos (PC1 y PC2)
ggplot(pca.df, aes(x=PC1, y=PC2, color=df_simpsons$target_obesidad)) +
geom_point(size=2) +
# scale_color_manual(values=c('royalblue', 'tomato', 'lightgreen', 'yellow', 'lightpink')) +
labs(title='PCA', x=x_label, y=y_label, color='Grupo') +
theme_classic() +
theme(panel.grid.major = element_line(color="gray90"), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "gray95"), plot.title = element_text(hjust = 0.5, face = "bold"))
View(df_simpsons)
# Representación gráfica de las primeras dos componentes principales respecto a los datos (PC1 y PC2)
ggplot(pca.df, aes(x=PC1, y=PC2, color=df_simpsons$cat_imc)) +
geom_point(size=2) +
# scale_color_manual(values=c('royalblue', 'tomato', 'lightgreen', 'yellow', 'lightpink')) +
labs(title='PCA', x=x_label, y=y_label, color='Grupo') +
theme_classic() +
theme(panel.grid.major = element_line(color="gray90"), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "gray95"), plot.title = element_text(hjust = 0.5, face = "bold"))
# Representación gráfica de las primeras dos componentes principales respecto a los datos (PC1 y PC2)
ggplot(pca.df, aes(x=PC1, y=PC2, color=df_simpsons$cat_imc)) +
geom_point(size=2) +
# scale_color_manual(values=c('royalblue', 'tomato', 'lightgreen', 'yellow', 'lightpink')) +
labs(title='PCA', x=x_label, y=y_label, color='Grupo') +
theme_classic() +
theme(panel.grid.major = element_line(color="gray90"), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "gray95"), plot.title = element_text(hjust = 0.5, face = "bold"))
# Representación gráfica de las primeras dos componentes principales respecto a los datos (PC1 y PC2)
ggplot(pca.df, aes(x=PC1, y=PC2, color=df_simpsons$cat_imc)) +
geom_point(size=2) +
# scale_color_manual(values=c('royalblue', 'tomato', 'lightgreen', 'yellow', 'lightpink')) +
labs(title='PCA', x=x_label, y=y_label, color='Grupo') +
theme_classic() +
theme(panel.grid.major = element_line(color="gray90"), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "gray95"), plot.title = element_text(hjust = 0.5, face = "bold"))
# Representación gráfica de las primeras dos componentes principales respecto a los datos (PC1 y PC2)
ggplot(pca.df, aes(x=PC1, y=PC2, color=df_simpsons$cat_imc)) +
geom_point(size=2) +
# scale_color_manual(values=c('royalblue', 'tomato', 'lightgreen', 'yellow', 'lightpink')) +
labs(title='PCA', x=x_label, y=y_label, color='Grupo') +
theme_classic() +
theme(panel.grid.major = element_line(color="gray90"), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "gray95"), plot.title = element_text(hjust = 0.5, face = "bold"))
head(pca.results$x)[, 1:6]
# Representación gráfica de las primeras dos componentes principales respecto a los datos (PC1 y PC2)
ggplot(pca.df, aes(x=PC1, y=PC2, color=df_simpsons$cat_imc)) +
geom_point(size=2) +
# scale_color_manual(values=c('royalblue', 'tomato', 'lightgreen', 'yellow', 'lightpink')) +
labs(title='PCA', x=x_label, y=y_label, color='Grupo') +
theme_classic() +
theme(panel.grid.major = element_line(color="gray90"), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "gray95"), plot.title = element_text(hjust = 0.5, face = "bold"))
View(pca.df)
pca.df <- data %>%
mutate(
# 1. Crear la categoría de 3 niveles para el gráfico del Paso 4
cat_imc = case_when(
imc_kg_m2 < 25 ~ "Normal",
imc_kg_m2 >= 25 & imc_kg_m2 < 30 ~ "Sobrepeso",
imc_kg_m2 >= 30 ~ "Obesidad"
),
# 2. Crear la variable BINARIA para la Regresión Logística del Paso 7
# Esta es la que sustituye a "Metástasis"
target_obesidad = ifelse(imc_kg_m2 >= 30, 1, 0),
# Convertirla a factor para que la regresión funcione bien
target_obesidad = factor(target_obesidad, labels = c("No Obeso", "Obeso"))
)
ggplot(pca.df, aes(x=PC1, y=PC2, color=pca.df$cat_imc)) +
geom_point(size=2) +
# scale_color_manual(values=c('royalblue', 'tomato', 'lightgreen', 'yellow', 'lightpink')) +
labs(title='PCA', x=x_label, y=y_label, color='Grupo') +
theme_classic() +
theme(panel.grid.major = element_line(color="gray90"), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "gray95"), plot.title = element_text(hjust = 0.5, face = "bold"))
pca.results <- prcomp(df_genes, center=TRUE, scale.=TRUE)
# Resultado de las componentes principales, x es el elemento de las puntuaciones del
# PCA que devuelve prcomp(). Es lo que estamos buscando.
pca.df <- data.frame(pca.results$x)
# Varianza (cuadrado de la desviacion tipica)
varianzas <- pca.results$sdev^2
# Total de la varianza de los datos
total.varianza <- sum(varianzas)
# Varianza explicada por cada componente principal
varianza.explicada <- varianzas/total.varianza
# Calculamos la varianza acumulada
varianza.acumulada <- cumsum(varianza.explicada)
# Tomamos el numero de componentes principales que explican el 90% de la varianza
n.pc <- min(which(varianza.acumulada > 0.90))
# Etiquetas de los ejes del gráfico
x_label <- paste0(paste('PC1', round(varianza.explicada[1] * 100, 2)), '%')
y_label <- paste0(paste('PC2', round(varianza.explicada[2] * 100, 2)), '%')
head(pca.results$x)[, 1:6]
summary(pca.results)
# Grafico del codo varianza vs PC
screeplot(pca.results, npcs = min(10, length(pca.results$sdev)), type=c("lines"))
```{r obesidad}
pca.df <- data %>%
mutate(
# 1. Crear la categoría de 3 niveles para el gráfico del Paso 4
cat_imc = case_when(
imc_kg_m2 < 25 ~ "Normal",
imc_kg_m2 >= 25 & imc_kg_m2 < 30 ~ "Sobrepeso",
imc_kg_m2 >= 30 ~ "Obesidad"
),
# 2. Crear la variable BINARIA para la Regresión Logística del Paso 7
# Esta es la que sustituye a "Metástasis"
target_obesidad = ifelse(imc_kg_m2 >= 30, 1, 0),
# Convertirla a factor para que la regresión funcione bien
target_obesidad = factor(target_obesidad, labels = c("No Obeso", "Obeso"))
)
ggplot(pca.df, aes(x=PC1, y=PC2, color=pca.df$cat_imc)) +
geom_point(size=2) +
# scale_color_manual(values=c('royalblue', 'tomato', 'lightgreen', 'yellow', 'lightpink')) +
labs(title='PCA', x=x_label, y=y_label, color='Grupo') +
theme_classic() +
theme(panel.grid.major = element_line(color="gray90"), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "gray95"), plot.title = element_text(hjust = 0.5, face = "bold"))
View(pca.df)
df_simpsons <- data %>%
mutate(
# 1. Crear la categoría de 3 niveles para el gráfico del Paso 4
cat_imc = case_when(
imc_kg_m2 < 25 ~ "Normal",
imc_kg_m2 >= 25 & imc_kg_m2 < 30 ~ "Sobrepeso",
imc_kg_m2 >= 30 ~ "Obesidad"
),
# 2. Crear la variable BINARIA para la Regresión Logística del Paso 7
# Esta es la que sustituye a "Metástasis"
target_obesidad = ifelse(imc_kg_m2 >= 30, 1, 0),
# Convertirla a factor para que la regresión funcione bien
target_obesidad = factor(target_obesidad, labels = c("No Obeso", "Obeso"))
)
pca.results <- prcomp(df_genes, center=TRUE, scale.=TRUE)
# Resultado de las componentes principales, x es el elemento de las puntuaciones del
# PCA que devuelve prcomp(). Es lo que estamos buscando.
pca.df <- data.frame(pca.results$x)
# Varianza (cuadrado de la desviacion tipica)
varianzas <- pca.results$sdev^2
# Total de la varianza de los datos
total.varianza <- sum(varianzas)
# Varianza explicada por cada componente principal
varianza.explicada <- varianzas/total.varianza
# Calculamos la varianza acumulada
varianza.acumulada <- cumsum(varianza.explicada)
# Tomamos el numero de componentes principales que explican el 90% de la varianza
n.pc <- min(which(varianza.acumulada > 0.90))
# Etiquetas de los ejes del gráfico
x_label <- paste0(paste('PC1', round(varianza.explicada[1] * 100, 2)), '%')
y_label <- paste0(paste('PC2', round(varianza.explicada[2] * 100, 2)), '%')
pca.df$cat_imc <- df_simpsons$cat_imc
ggplot(pca.df, aes(x=PC1, y=PC2, color=df_simpsons$cat_imc)) +
geom_point(size=2) +
# scale_color_manual(values=c('royalblue', 'tomato', 'lightgreen', 'yellow', 'lightpink')) +
labs(title='PCA', x=x_label, y=y_label, color='Grupo') +
theme_classic() +
theme(panel.grid.major = element_line(color="gray90"), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "gray95"), plot.title = element_text(hjust = 0.5, face = "bold"))
df_simpsons <- data %>%
mutate(
# 1. Crear la categoría de 3 niveles para el gráfico del Paso 4
cat_imc = case_when(
imc_kg_m2 < 25 ~ "Normal",
imc_kg_m2 >= 25 & imc_kg_m2 < 30 ~ "Sobrepeso",
imc_kg_m2 >= 30 ~ "Obesidad"
),
# 2. Crear la variable BINARIA para la Regresión Logística del Paso 7
# Esta es la que sustituye a "Metástasis"
target_obesidad = ifelse(imc_kg_m2 >= 30, 1, 0),
# Convertirla a factor para que la regresión funcione bien
target_obesidad = factor(target_obesidad, labels = c("No Obeso", "Obeso"))
) %>%
relocate(cat_imc, target_obesidad, .after = imc_kg_m2)
View(df_simpsons)
df_simpsons <- data %>%
mutate(
# 1. Crear la categoría de 3 niveles para el gráfico del Paso 4
cat_imc = case_when(
imc_kg_m2 < 25 ~ "Normal",
imc_kg_m2 >= 25 & imc_kg_m2 < 30 ~ "Sobrepeso",
imc_kg_m2 >= 30 ~ "Obesidad"
),
# 2. Crear la variable BINARIA (para la Regresión Logística del Paso 7)
target_obesidad = ifelse(imc_kg_m2 >= 30, 1, 0),
# Convertirla a factor para que la regresión funcione bien
target_obesidad = factor(target_obesidad, labels = c("No", "Si"))
) %>%
relocate(cat_imc, obesidad, .after = imc_kg_m2)
df_simpsons <- data %>%
mutate(
# 1. Crear la categoría de 3 niveles para el gráfico del Paso 4
cat_imc = case_when(
imc_kg_m2 < 25 ~ "Normal",
imc_kg_m2 >= 25 & imc_kg_m2 < 30 ~ "Sobrepeso",
imc_kg_m2 >= 30 ~ "Obesidad"
),
# 2. Crear la variable BINARIA (para la Regresión Logística del Paso 7)
target_obesidad = ifelse(imc_kg_m2 >= 30, 1, 0),
# Convertirla a factor para que la regresión funcione bien
target_obesidad = factor(target_obesidad, labels = c("No", "Si"))
) %>%
relocate(cat_imc, obesidad, .after = imc_kg_m2)
df_simpsons <- data %>%
mutate(
# 1. Crear la categoría de 3 niveles para el gráfico del Paso 4
cat_imc = case_when(
imc_kg_m2 < 25 ~ "Normal",
imc_kg_m2 >= 25 & imc_kg_m2 < 30 ~ "Sobrepeso",
imc_kg_m2 >= 30 ~ "Obesidad"
),
# 2. Crear la variable BINARIA (para la Regresión Logística del Paso 7)
target_obesidad = ifelse(imc_kg_m2 >= 30, 1, 0),
# Convertirla a factor para que la regresión funcione bien
obesidad = factor(obesidad, labels = c("No", "Si"))
) %>%
relocate(cat_imc, obesidad, .after = imc_kg_m2)
df_simpsons <- data %>%
mutate(
# 1. Crear la categoría de 3 niveles para el gráfico del Paso 4
cat_imc = case_when(
imc_kg_m2 < 25 ~ "Normal",
imc_kg_m2 >= 25 & imc_kg_m2 < 30 ~ "Sobrepeso",
imc_kg_m2 >= 30 ~ "Obesidad"
),
# 2. Crear la variable BINARIA (para la Regresión Logística del Paso 7)
obesidad = ifelse(imc_kg_m2 >= 30, 1, 0),
# Convertirla a factor para que la regresión funcione bien
obesidad = factor(obesidad, labels = c("No", "Si"))
) %>%
relocate(cat_imc, obesidad, .after = imc_kg_m2)
# Comprobación rápida: ¿Cuántos obesos hay?
table(data$obesidad)
data <- data %>%
mutate(
# 1. Crear la categoría de 3 niveles para el gráfico del Paso 4
cat_imc = case_when(
imc_kg_m2 < 25 ~ "Normal",
imc_kg_m2 >= 25 & imc_kg_m2 < 30 ~ "Sobrepeso",
imc_kg_m2 >= 30 ~ "Obesidad"
),
# 2. Crear la variable BINARIA (para la Regresión Logística del Paso 7)
obesidad = ifelse(imc_kg_m2 >= 30, 1, 0),
# Convertirla a factor para que la regresión funcione bien
obesidad = factor(obesidad, labels = c("No", "Si"))
) %>%
relocate(cat_imc, obesidad, .after = imc_kg_m2)
# Comprobación rápida: ¿Cuántos obesos hay?
table(data$obesidad)
pca.results <- prcomp(df_genes, center=TRUE, scale.=TRUE)
# Resultado de las componentes principales, x es el elemento de las puntuaciones del
# PCA que devuelve prcomp(). Es lo que estamos buscando.
pca.df <- data.frame(pca.results$x)
# Varianza (cuadrado de la desviacion tipica)
varianzas <- pca.results$sdev^2
# Total de la varianza de los datos
total.varianza <- sum(varianzas)
# Varianza explicada por cada componente principal
varianza.explicada <- varianzas/total.varianza
# Calculamos la varianza acumulada
varianza.acumulada <- cumsum(varianza.explicada)
# Tomamos el numero de componentes principales que explican el 90% de la varianza
n.pc <- min(which(varianza.acumulada > 0.90))
# Etiquetas de los ejes del gráfico
x_label <- paste0(paste('PC1', round(varianza.explicada[1] * 100, 2)), '%')
y_label <- paste0(paste('PC2', round(varianza.explicada[2] * 100, 2)), '%')
pca.df$cat_imc <- data$cat_imc
ggplot(pca.df, aes(x=PC1, y=PC2, color=pca.df$cat_imc)) +
geom_point(size=2) +
scale_color_manual(values=c('lightgreen', 'yellow', 'tomato')) +
labs(title='PCA', x=x_label, y=y_label, color='Grupo') +
theme_classic() +
theme(panel.grid.major = element_line(color="gray90"), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "gray95"), plot.title = element_text(hjust = 0.5, face = "bold"))
ggplot(pca.df, aes(x=PC1, y=PC2, color=cat_imc)) +
geom_point(size=2) +
scale_color_manual(values=c('lightgreen', 'yellow', 'tomato')) +
labs(title='PCA', x=x_label, y=y_label, color='Grupo') +
theme_classic() +
theme(panel.grid.major = element_line(color="gray90"), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "gray95"), plot.title = element_text(hjust = 0.5, face = "bold"))
ggplot(pca.df, aes(x=PC1, y=PC2, color=cat_imc)) +
geom_point(size=2) +
scale_color_manual(values=c('lightgreen', 'yellow', 'tomato')) +
labs(title='PCA', x=x_label, y=y_label, color='Grupo') +
theme_classic() +
theme(panel.grid.major = element_line(color="gray90"), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "gray95"), plot.title = element_text(hjust = 0.5, face = "bold"))
ggplot(pca.df, aes(x=PC1, y=PC2, color=cat_imc)) +
geom_point(size=2) +
scale_color_manual(values=c('lightgreen', '#fee12b', 'tomato')) +
labs(title='PCA', x=x_label, y=y_label, color='Grupo') +
theme_classic() +
theme(panel.grid.major = element_line(color="gray90"), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "gray95"), plot.title = element_text(hjust = 0.5, face = "bold"))
for (i in 1:6) {
data$PC{i} <- pca.df$PC{i}
for (i in 1:6): {
data <- cbind(data, pca.df[, 1:6])
View(data)
ggplot(pca.df, aes(x=PC1, y=PC2)) +
geom_point(size=2) +
#scale_color_manual(values=c('lightgreen', '#fee12b', 'tomato')) +
labs(title='PCA', x=x_label, y=y_label) +
theme_classic() +
theme(panel.grid.major = element_line(color="gray90"), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = "gray95"), plot.title = element_text(hjust = 0.5, face = "bold"))
#Crear el dataframe con los datos
tabla_varianza <- data.frame(
Componente = paste0("PC", 1:6),
R2 = round(varianza.explicada[1:6], 4),
R2_Acumulado = round(varianza.acumulada[1:6], 4)
)
knitr::kable(tabla_varianza,
col.names = c("Componente", "R2 (Varianza Explicada)", "R2 Acumulado"),
caption = "Tabla PCA componentes y R2. Proporción de varianza explicada por los primeros 6 componentes.")
# --------- Tabla de cargas ---------
# Extraer las cargas (rotation) de los primeros 6 componentes
cargas_df <- as.data.frame(pca.results$rotation[, 1:6])
# Añadir una columna con el nombre del gen (ahora son los nombres de fila)
cargas_df$Variable <- rownames(cargas_df)
cargas_df <- cargas_df %>% select(Variable, everything()) # Mover nombre al principio
# Paso 3: Mostrar la tabla (mostramos solo las primeras filas aquí como ejemplo)
knitr::kable(head(cargas_df, 6), # Quita el 'head' para mostrar todos en el Rmd final
digits = 3,
caption = "Tabla PCA cargas. Contribución de cada gen a los primeros 6 componentes principales.")
# --------- Tabla de cargas ---------
# Extraer las cargas (rotation) de los primeros 6 componentes
cargas_df <- as.data.frame(pca.results$rotation[, 1:6])
# Mostrar la tabla (mostramos solo las primeras filas aquí como ejemplo)
knitr::kable(head(cargas_df, 6), # Quita el 'head' para mostrar todos en el Rmd final
digits = 3,
caption = "Tabla PCA cargas. Contribución de cada gen a los primeros 6 componentes principales.")
# Mostrar la tabla (mostramos solo las primeras filas aquí como ejemplo)
knitr::kable(head(cargas_df, 10), # Quita el 'head' para mostrar todos en el Rmd final
digits = 3,
caption = "Tabla PCA cargas. Contribución de cada gen a los primeros 6 componentes principales.")
knitr::kable(data$obesidad,
caption = "Tabla 2. Resultados de evaluación de Normalidad en los\
datos de los genes mediante Kolmogorov-Smirnov.",
digits = 3)
knitr::kable(summary(data$obesidad),
caption = "Tabla 2. Resultados de evaluación de Normalidad en los\
datos de los genes mediante Kolmogorov-Smirnov.",
digits = 3)
data <- data %>%
mutate(
# Crear la categoria de 3 niveles para el grafico del Paso 4
cat_imc = case_when(
imc_kg_m2 < 25 ~ "Normal",
imc_kg_m2 >= 25 & imc_kg_m2 < 30 ~ "Sobrepeso",
imc_kg_m2 >= 30 ~ "Obesidad"
),
# Crear la variable BINARIA (para la Regresión Logistica del Paso 7)
obesidad = ifelse(imc_kg_m2 >= 30, 1, 0),
# Convertirla a factor para que la regresion funcione bien
obesidad = factor(obesidad, labels = c("No Obeso", "Obeso"))
) %>%
relocate(cat_imc, obesidad, .after = imc_kg_m2)
knitr::kable(summary(data$obesidad),
caption = "Tabla 2. Resultados de evaluación de Normalidad en los\
datos de los genes mediante Kolmogorov-Smirnov.",
digits = 3)
knitr::kable(summary(data$obesidad),
caption = "Tabla 2. Resultados de evaluación de Normalidad en los\
datos de los genes mediante Kolmogorov-Smirnov.",
col.names = c(" ", "N"),
digits = 3)
knitr::kable(summary(t(data$obesidad)),
caption = "Tabla 2. Resultados de evaluación de Normalidad en los\
datos de los genes mediante Kolmogorov-Smirnov.",
col.names = c(" ", "N"),
digits = 3)
knitr::kable(summary(t(data$obesidad)),
caption = "Tabla 2. Resultados de evaluación de Normalidad en los\
datos de los genes mediante Kolmogorov-Smirnov.",
col.names = c(" ", "N"),
digits = 3)
# Grafico del codo varianza vs PC
screeplot(pca.results, npcs = min(40, length(pca.results$sdev)), type=c("lines"))
# Grafico del codo varianza vs PC
screeplot(pca.results, npcs = min(20, length(pca.results$sdev)), type=c("lines"))
# Grafico del codo varianza vs PC
screeplot(pca.results, npcs = min(15, length(pca.results$sdev)), type=c("lines"))
# Grafico del codo varianza vs PC
screeplot(pca.results, npcs = 15, type= "lines") + plot_annotation(title = "Varianza vs. número de componentes principales")
# Grafico del codo varianza vs PC
screeplot(pca.results, npcs = 15, type= "lines") %>% plot_annotation(title = "Varianza vs. número de componentes principales")
# Grafico del codo varianza vs PC
screeplot((pca.results, npcs = 15, type= "lines") + plot_annotation(title = "Varianza vs. número de componentes principales"))
# Grafico del codo varianza vs PC
screeplot(pca.results, npcs = 15, type= "lines") + plot_annotation(title = "Varianza vs. número de componentes principales"))
# Grafico del codo varianza vs PC
screeplot(pca.results, npcs = 15, type= "lines") + labs(title = "Varianza vs. número de componentes principales")
# Grafico del codo varianza vs PC
ggplot(pca.results, aes=(screeplot(pca.results, npcs = 15, type= "lines")) + labs(title = "Varianza vs. número de componentes principales"))
View(pca.df)
View(pca.results)
install.packages("FactoMineR")
install.packages("FactoMineR")
library(FactoMineR)
pca_facto <- PCA(df_genes, ncp=6, graph = TRUE)
View(pca_facto)
pca_facto[["eig"]]
View(pca.results)
summary(pca_facto)
dim(pca.results$rotation)
# ------- Tabla de Varianza ---------
tabla_varianza <- data.frame(
Componente = paste0("PC", 1:6),
R2 = round(varianza.explicada[1:6], 4),
R2_Acumulado = round(varianza.acumulada[1:6], 4),
"R2_Acumulado*100%" = paste0((round(varianza.acumulada[1:6], 4)*100), "%")
)
knitr::kable(tabla_varianza,
col.names = c("Componente", "R2 (Varianza Explicada)", "R2 Acumulado"),
caption = "Tabla 2. Componentes PCA y R2. Proporción de varianza explicada de los primeros 6 componentes principales.")
knitr::kable(tabla_varianza,
col.names = c("Componente", "R2 (Varianza Explicada)", "R2 Acumulado", "R2 Acumulado (%)"),
caption = "Tabla 2. Componentes PCA y R2. Proporción de varianza explicada de los primeros 6 componentes principales.")
summary(pca.results)
pca_facto <- PCA(df_genes, ncp=2, graph = TRUE)
data <- data %>%
mutate(
# Crear una categoria de 3 niveles de peso
cat_imc = case_when(
imc_kg_m2 < 25 ~ "Normal",
imc_kg_m2 >= 25 & imc_kg_m2 < 30 ~ "Sobrepeso",
imc_kg_m2 >= 30 ~ "Obesidad"
),
# Crear una variable BINARIA (para la regresion logistica)
obesidad = ifelse(imc_kg_m2 >= 30, 1, 0),
# Convertirla a factor para que la regresion funcione bien
obesidad = factor(obesidad, labels = c("No Obeso", "Obeso"))
) %>%
relocate(cat_imc, obesidad, .after = imc_kg_m2)
n.pc
# Tomamos el numero de componentes principales que explican el 90% de la varianza
n.pc <- min(which(varianza.acumulada > 0.40))
n.pc
tabla_imc <- as.data.frame(data$cat_imc)
View(tabla_imc)
tabla_imc <- data.frame(
IMC = c( "IMC < 25", "25 <= IMC < 30", "IMC > 30"),
Condicion = c("Normal", "Sobrepeso", "Obesidad")
)
tabla_imc
knitr::kable(tabla_imc)
knitr::kable(tabla_imc, align = 'c')
tabla_imc <- data.frame(
IMC = c( "IMC < 25", "25 <= IMC < 30", "IMC > 30"),
Condición = c("Normal", "Sobrepeso", "Obesidad")
)
knitr::kable(tabla_imc, align = 'c')
knitr::opts_chunk$set(
echo = TRUE,
message = FALSE,
warning = FALSE,
fig.align = "center"
fig.cap = "center"
